window.SuperParticles=window.SuperParticles||class i{constructor(i={}){if("undefined"==typeof PIXI)throw Error("Failed to initialize SuperParticles because Pixi.js was missing!");5>parseInt(PIXI.VERSION.split(".").shift())&&console.warn("Old Pixi.js version detected. Features like FPS limiting won't be available. Switch to a version > 5.0.0-rc if possible."),this.defaultCfg={useJquery:!1,maxFps:30,autoStartAnimation:!0,container:{element:void 0,backgroundCssRule:"linear-gradient(0deg, rgba(24,74,110,1) 0%, rgba(20,116,180,1) 100%)"},pixiApp:{antialias:!1,transparent:!0,forceFXAA:!1,powerPreference:"high-performance",resolution:.9},particles:{amount:50,radius:2,velocity:15,color:"0xFFFFFF",fadeInDuration:3e3,fadeOutDuration:600,keepRelativePositionOnResize:!0},lines:{minDistance:.09,color:"0xFFFFFF",maxOpacity:.4,thickness:1,distanceBasedTransparency:!0},debug:{showFps:!1}},this.cfg=i,this._init()}_init(){this.linesLayer=void 0,this.particles=[],this.reinit()}reinit(){this.linesLayer=void 0,this.useJquery=void 0!==this.cfg.useJquery?this.cfg.useJquery:"undefined"!=typeof jQuery,this.divContainer=this.cfg.container.element;let{width:i,height:e}=this._getDivContainerSize();this.app=new PIXI.Application(this.cfg.pixiApp)}get cfg(){return void 0===this._cfg?this.defaultCfg:this._cfg}set cfg(i){if(this._cfg=this._mergeDeep(this.cfg,i),void 0!==this.particles&&this.particles.length>0)for(let e of this.particles)this._particleApplyCfg(e);"object"==typeof this.app&&(this.app.ticker.maxFPS=this.cfg.maxFps,"object"==typeof i.pixiApp&&Object.keys(i.pixiApp).length>0&&(console.warn("Changing pixiApp options during runtime completely reinitializes the pixi app instance."),this.destroy(!0,!0,!0,!1,!1,!0,!1),this.reinit()))}get divContainer(){return this._divContainer}set divContainer(i){switch(this._destroyContainer(),typeof i){case"undefined":this.divContainerIsGenerated=!0,this.useJquery?(this._divContainer=$("<div></div>"),this._divContainer.css({position:"absolute",width:"100%",height:"100%"}),null!==this.cfg.container.backgroundCssRule&&this._divContainer.css({background:this.cfg.container.backgroundCssRule}),$("body").prepend(this._divContainer)):(this._divContainer=document.createElement("div"),this._divContainer.style.position="absolute",this._divContainer.style.width="100%",this._divContainer.style.height="100%",null!==this.cfg.container.backgroundCssRule&&(this._divContainer.style.background=this.cfg.container.backgroundCssRule),document.body.insertBefore(this._divContainer,document.body.firstChild));break;case"string":this.divContainerIsGenerated=!1,this.useJquery?(this._divContainer=$(i),null!==this.cfg.container.backgroundCssRule&&this._divContainer.css({background:this.cfg.container.backgroundCssRule})):(this._divContainer=document.querySelector(i),null!==this.cfg.container.backgroundCssRule&&(this._divContainer.style.background=this.cfg.container.backgroundCssRule));break;case"null":this.divContainerIsGenerated=!1;break;default:this.divContainerIsGenerated=!1,this.useJquery?(this._divContainer=$(i),null!==this.cfg.container.backgroundCssRule&&this._divContainer.css({background:this.cfg.container.backgroundCssRule})):(this._divContainer=i,this._divContainer=document.querySelector(i),null!==this.cfg.container.backgroundCssRule&&(this._divContainer.style.background=this.cfg.container.backgroundCssRule)),this._containerApplyApp()}}get app(){return this._app}set app(i){this.destroy(!0,!0,!0,!1,!1,!1),this._app=i,i.renderer.autoDensity=!0;let e=this.particles.map(i=>({x:i.x,y:i.y}));for(let[t,s]of(this._containerApplyApp(),e.entries()))this.particles[t].x=s.x,this.particles[t].y=s.y;this._createParticles(),this._createLinesLayer(),this._createDebugOverlay(),this.cfg.autoStartAnimation&&this.startAnimation()}_containerApplyApp(){"object"==typeof this.app&&"object"==typeof this.divContainer&&null!==this.divContainer&&(this.useJquery?(this.divContainer.append(this.app.view),$(window).resize(this._resize.bind(this))):(this.divContainer.appendChild(this.app.view),window.addEventListener("resize",this._resize.bind(this))),this._resize())}destroy(i=!0,e=!0,t=!0,s=!0,r=!1,a=!0,n=!0){if(i){if("object"==typeof this.app&&"function"==typeof this.app.destroy){if(!n&&void 0!==this.particles)for(let h of this.particles)this.app.stage.removeChild(h);this.app.destroy(e,t),this._app=void 0}this.linesLayer=void 0,n&&this.particles,this.debugOverlay=void 0}(s||r)&&this._destroyContainer(r),(a||s||r)&&(this.useJquery?$(window).off("resize"):window.removeEventListener("resize",this._resize))}_destroyContainer(i=!1){(i||this.divContainerIsGenerated)&&"object"==typeof this.divContainer&&null!==this.divContainer&&(this.useJquery?(this.divContainer.remove(),this._divContainer=null):(this.divContainer.parentNode.removeChild(this.divContainer),this._divContainer=null))}_particleApplyCfg(i){i.clear(),i.beginFill(this.cfg.particles.color),i.drawCircle(0,0,this.cfg.particles.radius),i.endFill()}_createParticles(){for(let i of this.particles)this.app.stage.addChild(i);let e=this.cfg.particles.amount-this.particles.length,t=0-e;for(let s=0;s<e;s++){let r=this._getRandomCoord(),a=new PIXI.Graphics;a.x=r.x,a.y=r.y,a.direction=this._getUpRight(),a.alpha=0,this._particleApplyCfg(a),this.particles.push(a),this.app.stage.addChild(a)}for(let n=0;n<t;n++)this.app.stage.removeChild(this.particles[0]),this.particles.shift()}_createLinesLayer(){this.linesLayer=new PIXI.Graphics,this.app.stage.addChild(this.linesLayer)}_createDebugOverlay(){this.debugOverlay=new PIXI.Text("Debug Info",{fill:16777215,strokeThickness:2,stroke:0}),this.visible=!1,this.debugOverlay.x=0,this.debugOverlay.y=0,this.debugOverlay.lastUpdate=0,this.app.stage.addChild(this.debugOverlay)}_getRandomInt(i,e){return i=Math.ceil(i),Math.floor(Math.random()*((e=Math.floor(e))-i+1))+i}_getRandomFloat(i,e){return Math.random()*(e-i)+i}_getDistance(i,e){return Math.sqrt((i.x-e.x)**2+(i.y-e.y)**2)}_getDistancePercent(i,e){let t=this._getDistance(i,e),s=this._absoluteDistanceToPercentDistance(t);return s}_absoluteDistanceToPercentDistance(i){return i/this.diagonalSize}_getRandomCoord(){return{x:this._getRandomFloat(0,this.app.renderer.screen.width),y:this._getRandomFloat(0,this.app.renderer.screen.height)}}_getRandomDirection(){return Math.random()*Math.PI*2}_getUpRight(){return-Math.PI/4}_isCoordInView(i){return!!(i.x>=0-this.cfg.particles.radius&&i.y>=0-this.cfg.particles.radius&&i.x<this.app.renderer.screen.width+this.cfg.particles.radius&&i.y<this.app.renderer.screen.height+this.cfg.particles.radius)}_getDivContainerSize(){let i,e;return this.useJquery?(i=this.divContainer.width(),e=this.divContainer.height()):(i=this.divContainer.clientWidth,e=this.divContainer.clientHeight),{width:i,height:e}}_resize(){let{width:i,height:e}=this._getDivContainerSize();if(this.cfg.particles.keepRelativePositionOnResize){let t=this.app.renderer.screen.width,s=this.app.renderer.screen.height;for(let r of(this.diagonalSize=this._getDistance({x:0,y:0},{x:i,y:e}),this.particles))r.x=r.x*i/t,r.y=r.y*e/s}this.app.renderer.resize(i,e)}startAnimation(){this.app.ticker.autoStart=!0,this.app.ticker.speed=1,this.app.ticker.maxFPS=this.cfg.maxFps,this.app.ticker.started?this.app.ticker.add(i=>{this.linesLayer.clear(),this.linesLayer.lineStyle(this.cfg.lines.thickness,this.cfg.lines.color,1);let e=[];for(let t of this.particles){if(t.x+=Math.cos(t.direction)*this.cfg.particles.velocity/this.cfg.maxFps*i,t.y+=Math.sin(t.direction)*this.cfg.particles.velocity/this.cfg.maxFps*i,this._isCoordInView(t)){if(1!==t.alpha){let s=t.alpha+1e3/this.cfg.particles.fadeInDuration/(this.cfg.maxFps*i);t.alpha=s>1?1:s}}else{let r=t.alpha-1e3/this.cfg.particles.fadeOutDuration/(this.cfg.maxFps*i);if(t.alpha=r<0?0:r,0===t.alpha){let a=this._getRandomCoord();t.x=a.x,t.y=a.y,t.direction=this._getRandomDirection()}}for(let n of this.particles){let h=this._getDistancePercent(t,n),o=this.cfg.lines.minDistance;if(0!==h&&h<=o){let l={p1:{x:t.x,y:t.y},p2:{x:n.x,y:n.y}},c=e.filter(i=>i.p1.x===l.p1.x&&i.p1.y===l.p1.y&&i.p2.x===l.p2.x&&i.p2.y===l.p2.y);if(0===c.length){let p=t.alpha>n.alpha?n.alpha:t.alpha;if(p=p>this.cfg.lines.maxOpacity?this.cfg.lines.maxOpacity:p,this.cfg.lines.distanceBasedTransparency){let d=(1-h/o)*p;this.linesLayer.lineStyle(this.cfg.lines.thickness,this.cfg.lines.color,d)}this.linesLayer.moveTo(t.x,t.y),this.linesLayer.lineTo(n.x,n.y),e.push(l)}}}}if(this.cfg.debug.showFps){let g=performance.now();if(g>this.debugOverlay.lastUpdate+500){this.debugOverlay.visible=!0;let u=Math.round(this.app.ticker.FPS);this.debugOverlay.text=`${u} FPS`,this.debugOverlay.lastUpdate=g}}else this.debugOverlay.visible=!1}):this.app.ticker.start()}stopAnimation(){"object"==typeof this.app.ticker&&this.app.ticker.stop()}_isObject(i){return i&&"object"==typeof i&&!Array.isArray(i)}_mergeDeep(i,...e){if(!e.length)return i;let t=e.shift();if(this._isObject(i)&&this._isObject(t))for(let s in t)this._isObject(t[s])?(i[s]||Object.assign(i,{[s]:{}}),this._mergeDeep(i[s],t[s])):Object.assign(i,{[s]:t[s]});return this._mergeDeep(i,...e)}};